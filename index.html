<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lufthansa Group | Crew Portal</title>
    
    <style>
        /* --- CORPORATE LUFTHANSA STYLE --- */
        :root {
            --lh-blue: #05164D;       /* Фирменный темно-синий */
            --lh-blue-light: #0b225f;
            --lh-yellow: #FFB100;     /* Фирменный желтый */
            --lh-grey-bg: #F2F4F7;    /* Светло-серый фон сайта */
            --lh-grey-text: #666666;
            --lh-border: #dcdcdc;
            --white: #ffffff;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; }
        
        body { 
            background-color: var(--lh-grey-bg);
            color: #333;
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* --- UTILITIES --- */
        .hidden { display: none !important; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        
        /* Кнопки */
        .btn {
            display: inline-block; padding: 12px 24px; font-size: 14px; font-weight: bold;
            text-transform: uppercase; border: none; cursor: pointer; border-radius: 2px;
            transition: 0.2s; letter-spacing: 0.5px;
        }
        .btn-primary {
            background-color: var(--lh-blue); color: white;
        }
        .btn-primary:hover { background-color: var(--lh-blue-light); }
        
        .btn-yellow {
            background-color: var(--lh-yellow); color: var(--lh-blue);
        }
        .btn-yellow:hover { background-color: #e6a000; }

        /* Карточки */
        .card {
            background: var(--white);
            border: 1px solid var(--lh-border);
            border-radius: 3px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .card h3 { color: var(--lh-blue); margin-bottom: 10px; font-weight: bold; }
        
        /* Формы */
        label { display: block; margin-bottom: 5px; font-weight: bold; font-size: 0.9rem; color: var(--lh-blue); }
        select, input {
            width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 2px;
            margin-bottom: 15px; font-size: 1rem; background: #fff;
        }
        select:focus, input:focus { border-color: var(--lh-blue); outline: none; }

        /* --- 1. WELCOME SCREEN (SPLASH) --- */
        #welcome-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: var(--lh-blue);
            z-index: 9999;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            color: white;
            transition: opacity 1s ease-out;
        }
        .crane-logo-big {
            font-size: 80px; margin-bottom: 20px;
            width: 120px; height: 120px; border: 2px solid var(--lh-yellow); border-radius: 50%;
            display: flex; align-items: center; justify-content: center; color: var(--lh-yellow);
        }

        /* --- 2. LOGIN SCREEN --- */
        #login-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: url('https://images.unsplash.com/photo-1436491865332-7a61a109cc05?q=80&w=2074&auto=format&fit=crop') no-repeat center center/cover;
            z-index: 8000;
            display: flex; justify-content: center; align-items: center;
        }
        .login-box {
            background: rgba(255, 255, 255, 0.95);
            width: 400px; padding: 40px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            border-top: 5px solid var(--lh-yellow);
        }

        /* --- 3. HEADER & NAV --- */
        header {
            background-color: var(--lh-blue); color: white;
            height: 70px; display: flex; align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .header-content {
            width: 100%; max-width: 1200px; margin: 0 auto; padding: 0 20px;
            display: flex; justify-content: space-between; align-items: center;
        }
        .logo-text { font-size: 1.2rem; font-weight: bold; letter-spacing: 1px; }
        
        nav { display: flex; gap: 20px; }
        .nav-link {
            color: rgba(255,255,255,0.8); text-decoration: none; font-size: 0.9rem;
            text-transform: uppercase; cursor: pointer; transition: 0.3s; padding: 22px 0;
            border-bottom: 3px solid transparent;
        }
        .nav-link:hover, .nav-link.active { color: white; border-bottom-color: var(--lh-yellow); }

        /* Mobile Nav */
        @media (max-width: 768px) {
            header { height: auto; padding: 15px 0; }
            .header-content { flex-direction: column; gap: 15px; }
            nav { flex-wrap: wrap; justify-content: center; gap: 15px; }
            .nav-link { padding: 5px; }
            .grid-cards { grid-template-columns: 1fr !important; }
        }

        /* --- 4. CONTENT SECTIONS --- */
        .grid-cards { display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 20px; }
        
        /* Status Bar Widget */
        .status-widget {
            background: white; border-left: 5px solid var(--lh-blue);
            padding: 20px; display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 30px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        /* Tabs inside Destinations */
        .filter-tabs { margin-bottom: 20px; border-bottom: 1px solid #ccc; }
        .filter-tab {
            display: inline-block; padding: 10px 20px; cursor: pointer;
            border: 1px solid transparent; border-bottom: none;
            margin-bottom: -1px; background: transparent;
        }
        .filter-tab.active {
            background: white; border-color: #ccc; border-top: 3px solid var(--lh-blue); font-weight: bold;
        }

        /* Flight Info Table Style */
        .flight-detail-row {
            display: flex; justify-content: space-between; border-bottom: 1px solid #eee; padding: 10px 0;
        }
        .flight-detail-row span:first-child { color: var(--lh-grey-text); }
        .flight-detail-row span:last-child { font-weight: bold; color: var(--lh-blue); }

    </style>
</head>
<body>

    <div id="welcome-screen">
        <div class="crane-logo-big">✈</div>
        <h1 style="font-weight: 300; letter-spacing: 2px;">LUFTHANSA GROUP</h1>
        <p style="margin-top: 10px; font-size: 0.9rem; opacity: 0.8;">CREW PORTAL LOADING...</p>
    </div>

    <div id="login-screen" class="hidden">
        <div class="login-box">
            <h2 style="color: var(--lh-blue); margin-bottom: 20px;">Crew Login</h2>
            <p style="color: var(--lh-grey-text); margin-bottom: 20px; font-size: 0.9rem;">Please enter your credentials to access the operations portal.</p>
            
            <label>Callsign</label>
            <input type="text" id="callsign" placeholder="e.g. DLH001">
            
            <label>Password</label>
            <input type="password" id="password">
            
            <button class="btn btn-primary" style="width: 100%; margin-top: 10px;" onclick="attemptLogin()">Log In</button>
            <p id="login-error" style="color: #d9534f; margin-top: 15px; font-size: 0.9rem; display: none;">Invalid credentials.</p>
        </div>
    </div>

    <div id="dashboard" class="hidden">
        <header>
            <div class="header-content">
                <div class="logo-text">
                    <span style="color: var(--lh-yellow); margin-right: 5px;">✈</span> LUFTHANSA GROUP <span style="font-weight:300">PORTAL</span>
                </div>
                <nav>
                    <span class="nav-link active" onclick="navTo('home', this)">Home</span>
                    <span class="nav-link" onclick="navTo('fleet', this)">Fleet</span>
                    <span class="nav-link" onclick="navTo('destinations', this)">Flights</span>
                    <span class="nav-link" onclick="navTo('generator', this)">Dispatch</span>
                    <span class="nav-link" onclick="navTo('myflight', this)">My Flight</span>
                </nav>
            </div>
        </header>

        <div class="container">
            
            <div style="margin: 20px 0; display: flex; align-items: center; justify-content: space-between;">
                <h2 style="color: var(--lh-blue);">Welcome, <span id="pilot-name">Captain</span></h2>
                <div style="background: white; padding: 5px 15px; border-radius: 20px; font-size: 0.9rem; border: 1px solid #ddd;">
                    Status: <span style="color: green; font-weight: bold;">● Online</span>
                </div>
            </div>

            <div id="active-flight-widget" class="status-widget hidden">
                <div>
                    <h4 style="color: var(--lh-grey-text); margin: 0; font-size: 0.8rem; text-transform: uppercase;">Active Duty</h4>
                    <h2 style="margin: 5px 0; color: var(--lh-blue);"><span id="widget-call">DLH000</span></h2>
                    <span id="widget-route">FRA - JFK</span>
                </div>
                <button class="btn btn-yellow" onclick="navTo('myflight', document.querySelectorAll('.nav-link')[4])">View Flight</button>
            </div>

            <section id="sec-home">
                <div class="grid-cards">
                    <div class="card">
                        <h3>Corporate News</h3>
                        <p style="color: var(--lh-grey-text);">Welcome to the new Crew Portal. We have integrated all group airlines (Lufthansa, Swiss, Austrian, Eurowings) into a single operational interface.</p>
                    </div>
                    <div class="card">
                        <h3>Operational Guidelines</h3>
                        <ul style="padding-left: 20px; color: var(--lh-grey-text); font-size: 0.9rem;">
                            <li>Flights must be conducted in Real Time.</li>
                            <li>OFP generation is mandatory.</li>
                            <li>Report submission required post-flight.</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h3>Network Status</h3>
                        <p style="color: green; font-weight: bold;">System Operational</p>
                        <p style="font-size: 0.9rem; color: #666;">Hubs active: FRA, MUC, ZRH, VIE</p>
                    </div>
                </div>
            </section>

            <section id="sec-fleet" class="hidden">
                <h3 style="color: var(--lh-blue); margin-bottom: 20px; border-bottom: 2px solid var(--lh-yellow); padding-bottom: 10px;">Aircraft Fleet</h3>
                <div id="fleet-grid" class="grid-cards"></div>
            </section>

            <section id="sec-destinations" class="hidden">
                <h3 style="color: var(--lh-blue); margin-bottom: 20px; border-bottom: 2px solid var(--lh-yellow); padding-bottom: 10px;">Flight Schedule</h3>
                
                <div class="card">
                    <div style="display: flex; gap: 20px; flex-wrap: wrap;">
                        <div style="flex: 1;">
                            <label>Airline Operator</label>
                            <select id="dest-airline" onchange="updateDestHubs()">
                                <option value="">Select Operator...</option>
                            </select>
                        </div>
                        <div style="flex: 1;">
                            <label>Departure Hub</label>
                            <select id="dest-hub" disabled onchange="filterDestinations()">
                                <option value="">Select Hub...</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div id="dest-list">
                    </div>
            </section>

            <section id="sec-generator" class="hidden">
                <h3 style="color: var(--lh-blue); margin-bottom: 20px; border-bottom: 2px solid var(--lh-yellow); padding-bottom: 10px;">Dispatch Center</h3>
                
                <div id="gen-warning" class="card hidden" style="border-left: 5px solid #d9534f;">
                    <h3 style="color: #d9534f;">Flight Already Active</h3>
                    <p>You currently have an active flight plan. Please complete it or cancel it before generating a new one.</p>
                </div>

                <div id="gen-form" class="card" style="max-width: 600px; margin: 0 auto;">
                    <label>Preferred Callsign (Optional)</label>
                    <input type="text" id="gen-call" placeholder="e.g. DLH452">

                    <label>Airline Operator</label>
                    <select id="gen-airline" onchange="updateGenHubs()">
                        <option value="">Select Operator...</option>
                    </select>

                    <label>Departure Hub</label>
                    <select id="gen-hub" disabled>
                        <option value="">Select Hub...</option>
                    </select>

                    <label>Flight Duration</label>
                    <select id="gen-time">
                        <option value="1-2">Short Haul (1-2h)</option>
                        <option value="3-4">Medium Haul (3-4h)</option>
                        <option value="5-6">Long Haul (5-6h)</option>
                        <option value="7-8">Long Haul (7-8h)</option>
                        <option value="10+">Ultra Long Haul (10h+)</option>
                    </select>

                    <button class="btn btn-primary" style="width: 100%; margin-top: 10px;" onclick="generateFlight()">Generate Flight Plan</button>
                </div>
            </section>

            <section id="sec-myflight" class="hidden">
                <h3 style="color: var(--lh-blue); margin-bottom: 20px; border-bottom: 2px solid var(--lh-yellow); padding-bottom: 10px;">Active Flight Plan</h3>
                
                <div id="no-flight-msg" class="card" style="text-align: center; padding: 50px;">
                    <p style="color: #999;">No active flight plan filed.</p>
                    <button class="btn btn-primary" style="margin-top: 10px;" onclick="navTo('generator', document.querySelectorAll('.nav-link')[3])">Go to Dispatch</button>
                </div>

                <div id="flight-detail-card" class="card hidden" style="max-width: 800px; margin: 0 auto;">
                    <div style="display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #eee; padding-bottom: 20px; margin-bottom: 20px;">
                        <div>
                            <h1 id="mf-callsign" style="color: var(--lh-blue); margin-bottom: 5px;">DLH---</h1>
                            <span style="background: var(--lh-yellow); padding: 3px 8px; font-size: 0.8rem; font-weight: bold; border-radius: 2px;">FILED</span>
                        </div>
                        <div style="text-align: right;">
                            <h2 id="mf-route" style="color: #333;">---</h2>
                        </div>
                    </div>

                    <div class="flight-detail-row"><span>Aircraft Type</span> <span id="mf-ac">-</span></div>
                    <div class="flight-detail-row"><span>Operator</span> <span id="mf-airline">-</span></div>
                    <div class="flight-detail-row"><span>Block Time</span> <span id="mf-time">-</span></div>
                    <div class="flight-detail-row"><span>Departure (UTC)</span> <span id="mf-dep">-</span></div>
                    <div class="flight-detail-row"><span>Est. Arrival (Local)</span> <span id="mf-arr">-</span></div>

                    <div style="margin-top: 30px; display: flex; gap: 10px;">
                        <button class="btn btn-primary" style="flex: 1;" onclick="alert('OFP Downloaded (Simulated)')">Download OFP</button>
                        <button class="btn" style="flex: 1; background: #d9534f; color: white;" onclick="endFlight()">File Report & Close</button>
                    </div>
                </div>
            </section>

        </div>
    </div>

    <script>
        // --- DATA ---
        const pilots = [ { id: "DLH001", pass: "admin" }, { id: "SWR100", pass: "swiss" } ];
        
        const airlines = [
            { code: "DLH", name: "Lufthansa", hubs: ["EDDF", "EDDM"] },
            { code: "SWR", name: "Swiss", hubs: ["LSZH"] },
            { code: "AUA", name: "Austrian", hubs: ["LOWW"] },
            { code: "EWG", name: "Eurowings", hubs: ["EDDL", "EDDH"] }
        ];

        const fleet = [
            { type: "Airbus A320neo", range: 6, reg: "D-AINA" },
            { type: "Airbus A321", range: 7, reg: "D-AISP" },
            { type: "Airbus A330-300", range: 11, reg: "D-AIKO" },
            { type: "Airbus A350-900", range: 17, reg: "D-AIXA" },
            { type: "Boeing 747-8", range: 15, reg: "D-ABYA" },
            { type: "Bombardier CRJ-900", range: 4, reg: "D-ACNW" }
        ];

        const routes = [
            { d: "EDDF", a: "KJFK", t: 8.5 }, { d: "EDDF", a: "EGLL", t: 1.5 },
            { d: "EDDF", a: "UUEE", t: 3.5 }, { d: "EDDM", a: "OMDB", t: 6.0 },
            { d: "LSZH", a: "WSSS", t: 12.0 }, { d: "LSZH", a: "EGLL", t: 1.8 },
            { d: "LOWW", a: "VTBS", t: 10.0 }, { d: "EDDL", a: "LEPA", t: 2.5 }
        ];

        // --- INIT ---
        window.onload = function() {
            // Intro animation
            setTimeout(() => {
                document.getElementById('welcome-screen').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('welcome-screen').style.display = 'none';
                    document.getElementById('login-screen').classList.remove('hidden');
                }, 1000);
            }, 2500);

            initSelects();
            renderFleet();
            checkState();
        };

        // --- HELPERS ---
        function navTo(id, el) {
            // Nav active state
            document.querySelectorAll('.nav-link').forEach(n => n.classList.remove('active'));
            if(el) el.classList.add('active');

            // Show section
            document.querySelectorAll('section').forEach(s => s.classList.add('hidden'));
            document.getElementById('sec-' + id).classList.remove('hidden');
        }

        function initSelects() {
            const gs = document.getElementById('gen-airline');
            const ds = document.getElementById('dest-airline');
            airlines.forEach(a => {
                gs.add(new Option(a.name, a.code));
                ds.add(new Option(a.name, a.code));
            });
        }

        // --- AUTH ---
        function attemptLogin() {
            const c = document.getElementById('callsign').value.toUpperCase();
            const p = document.getElementById('password').value;
            const u = pilots.find(x => x.id === c && x.pass === p);
            
            if(u) {
                document.getElementById('login-screen').classList.add('hidden');
                document.getElementById('dashboard').classList.remove('hidden');
                document.getElementById('pilot-name').innerText = c;
            } else {
                document.getElementById('login-error').style.display = 'block';
            }
        }

        // --- FLEET ---
        function renderFleet() {
            const grid = document.getElementById('fleet-grid');
            fleet.forEach(ac => {
                grid.innerHTML += `
                    <div class="card">
                        <div style="font-weight:bold; color:#05164D; font-size:1.1rem;">${ac.type}</div>
                        <div style="color:#666; font-size:0.9rem;">Max Range: ${ac.range}h</div>
                    </div>
                `;
            });
        }

        // --- FLIGHT LOGIC ---
        function updateHubs(selectId, targetId) {
            const code = document.getElementById(selectId).value;
            const target = document.getElementById(targetId);
            target.innerHTML = '<option value="">Select Hub...</option>';
            target.disabled = true;

            if(code) {
                const al = airlines.find(a => a.code === code);
                al.hubs.forEach(h => target.add(new Option(h, h)));
                target.disabled = false;
            }
        }
        function updateDestHubs() { updateHubs('dest-airline', 'dest-hub'); }
        function updateGenHubs() { updateHubs('gen-airline', 'gen-hub'); }

        function filterDestinations() {
            const hub = document.getElementById('dest-hub').value;
            const list = document.getElementById('dest-list');
            list.innerHTML = '';
            
            if(!hub) return;

            const matches = routes.filter(r => r.d === hub);
            if(matches.length === 0) {
                list.innerHTML = '<div class="card">No flights available from this hub in current database.</div>';
                return;
            }

            matches.forEach(r => {
                const airlineCode = document.getElementById('dest-airline').value;
                list.innerHTML += `
                    <div class="card" style="display:flex; justify-content:space-between; align-items:center;">
                        <div>
                            <div style="font-size:1.2rem; font-weight:bold; color:var(--lh-blue);">${r.d} ➝ ${r.a}</div>
                            <div style="color:#666;">Flight Time: ${r.t}h</div>
                        </div>
                        <button class="btn btn-yellow" onclick="takeFlight('${r.d}', '${r.a}', ${r.t}, '${airlineCode}')">Select Flight</button>
                    </div>
                `;
            });
        }

        // --- ACTION: TAKE FLIGHT ---
        function takeFlight(dep, arr, time, alCode) {
            if(localStorage.getItem('flight')) {
                alert("Error: You already have an active flight plan filed.");
                return;
            }
            
            const al = airlines.find(a => a.code === alCode);
            const plane = fleet.find(f => f.range >= time);
            
            if(!plane) { alert("No suitable aircraft found for this duration."); return; }

            const callsign = alCode + Math.floor(Math.random()*899+100);
            createFlight(callsign, dep, arr, time, plane.type, al.name);
        }

        function generateFlight() {
            if(localStorage.getItem('flight')) { alert("Active flight plan exists."); return; }
            
            const alCode = document.getElementById('gen-airline').value;
            const hub = document.getElementById('gen-hub').value;
            const timeRange = document.getElementById('gen-time').value;
            const customCall = document.getElementById('gen-call').value.toUpperCase();

            if(!alCode || !hub) { alert("Please select Operator and Hub."); return; }

            let min, max;
            if(timeRange === '10+') { min=10; max=99; }
            else { const s=timeRange.split('-'); min=Number(s[0]); max=Number(s[1]); }

            const matches = routes.filter(r => r.d === hub && r.t >= min && r.t <= max);
            
            if(matches.length === 0) { alert("No routes match your criteria."); return; }
            
            const r = matches[Math.floor(Math.random() * matches.length)];
            const plane = fleet.find(f => f.range >= r.t);
            const al = airlines.find(a => a.code === alCode);
            const callsign = customCall || (alCode + Math.floor(Math.random()*899+100));

            createFlight(callsign, r.d, r.a, r.t, plane.type, al.name);
        }

        function createFlight(call, dep, arr, time, plane, airline) {
            const now = new Date();
            const arrival = new Date(now.getTime() + time*3600000);
            
            const flight = {
                call: call,
                dep: dep, arr: arr,
                time: time,
                plane: plane,
                airline: airline,
                depTime: now.toISOString().slice(11,16) + ' Z',
                arrTime: arrival.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})
            };

            localStorage.setItem('flight', JSON.stringify(flight));
            alert("Flight Plan Filed Successfully: " + call);
            checkState();
            navTo('myflight', document.querySelectorAll('.nav-link')[4]);
        }

        function endFlight() {
            if(confirm("Confirm: File flight report and close flight plan?")) {
                localStorage.removeItem('flight');
                checkState();
                navTo('home', document.querySelectorAll('.nav-link')[0]);
            }
        }

        function checkState() {
            const data = localStorage.getItem('flight');
            const widget = document.getElementById('active-flight-widget');
            const noFlight = document.getElementById('no-flight-msg');
            const detail = document.getElementById('flight-detail-card');
            const genWarn = document.getElementById('gen-warning');
            const genForm = document.getElementById('gen-form');

            if(data) {
                const f = JSON.parse(data);
                
                // Widget
                widget.classList.remove('hidden');
                document.getElementById('widget-call').innerText = f.call;
                document.getElementById('widget-route').innerText = `${f.dep} - ${f.arr}`;

                // Details
                noFlight.classList.add('hidden');
                detail.classList.remove('hidden');
                
                document.getElementById('mf-callsign').innerText = f.call;
                document.getElementById('mf-route').innerText = `${f.dep} ➝ ${f.arr}`;
                document.getElementById('mf-ac').innerText = f.plane;
                document.getElementById('mf-airline').innerText = f.airline;
                document.getElementById('mf-time').innerText = f.time + ' hours';
                document.getElementById('mf-dep').innerText = f.depTime;
                document.getElementById('mf-arr').innerText = f.arrTime;

                // Generator Lock
                genWarn.classList.remove('hidden');
                genForm.classList.add('hidden');

            } else {
                widget.classList.add('hidden');
                noFlight.classList.remove('hidden');
                detail.classList.add('hidden');
                genWarn.classList.add('hidden');
                genForm.classList.remove('hidden');
            }
        }

    </script>
</body>
</html>
