<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lufthansa Group VA Portal</title>
    <style>
        /* --- 1. CONFIG & VARIABLES --- */
        :root {
            --lh-blue: #05164d;
            --lh-yellow: #ffb600;
            --lh-grey: #e6e6e6;
            --lh-text: #333;
            --white: #ffffff;
            --shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; }
        body { background-color: var(--lh-grey); color: var(--lh-text); overflow-x: hidden; }

        /* --- 2. UTILITIES & ANIMATIONS --- */
        .hidden { display: none !important; }
        .fade-in { animation: fadeIn 0.8s ease-in-out; }
        .slide-up { animation: slideUp 0.6s ease-out; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        /* --- 3. UI COMPONENTS --- */
        .btn {
            background-color: var(--lh-blue);
            color: var(--white);
            border: none;
            padding: 10px 20px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            border-radius: 2px;
            text-transform: uppercase;
            font-weight: bold;
        }
        .btn:hover { background-color: #0b2575; }
        .btn-yellow { background-color: var(--lh-yellow); color: var(--lh-blue); }
        .btn-yellow:hover { background-color: #ffcc33; }
        
        input, select {
            width: 100%;
            padding: 10px;
            margin: 5px 0 15px 0;
            border: 1px solid #ccc;
            border-radius: 2px;
        }

        .card {
            background: var(--white);
            padding: 20px;
            border-radius: 4px;
            box-shadow: var(--shadow);
            margin-bottom: 20px;
            border-left: 5px solid var(--lh-yellow);
        }

        /* --- 4. SECTIONS --- */
        
        /* Welcome Screen */
        #welcome-screen {
            height: 100vh;
            background: var(--lh-blue);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: var(--white);
            text-align: center;
            z-index: 1000;
        }
        .lh-logo { font-size: 3rem; font-weight: bold; margin-bottom: 10px; }
        .crane { font-size: 5rem; color: var(--lh-yellow); margin-bottom: 20px; display: block; }

        /* Login Screen */
        #login-screen {
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: url('https://images.unsplash.com/photo-1436491865332-7a61a109cc05?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80') center/cover no-repeat;
        }
        .login-box {
            background: rgba(255, 255, 255, 0.95);
            padding: 40px;
            border-radius: 5px;
            width: 350px;
            text-align: center;
            box-shadow: var(--shadow);
        }

        /* Main Dashboard */
        header {
            background-color: var(--lh-blue);
            color: var(--white);
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        nav {
            background-color: #fff;
            padding: 10px 30px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            overflow-x: auto;
            white-space: nowrap;
        }
        nav button {
            background: none;
            border: none;
            color: var(--lh-blue);
            font-weight: bold;
            margin-right: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            padding-bottom: 5px;
        }
        nav button:hover, nav button.active { border-bottom: 2px solid var(--lh-yellow); }

        .container { max-width: 1200px; margin: 30px auto; padding: 0 20px; }
        
        h2 { color: var(--lh-blue); margin-bottom: 20px; border-bottom: 2px solid var(--lh-yellow); display: inline-block; padding-bottom: 5px; }

        /* Fleet Grid */
        .fleet-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px; }
        .aircraft-card img { width: 100%; height: 150px; object-fit: cover; border-radius: 2px; }
        
        /* Active Flight Banner */
        #active-flight-banner {
            background: var(--lh-blue);
            color: var(--white);
            padding: 15px;
            text-align: center;
            margin-bottom: 20px;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

    </style>
</head>
<body>

    <div id="welcome-screen" class="fade-in">
        <span class="crane">✈</span>
        <div class="lh-logo">LUFTHANSA GROUP</div>
        <p>Virtual Airline System</p>
        <br>
        <button class="btn btn-yellow" onclick="goToLogin()">Enter Portal</button>
    </div>

    <div id="login-screen" class="hidden">
        <div class="login-box slide-up">
            <h2 style="border:none; color:var(--lh-blue);">Crew Login</h2>
            <p style="margin-bottom:20px; font-size:0.9rem;">Введите ваш позывной и пароль</p>
            <input type="text" id="callsign" placeholder="Callsign (e.g., DLH001)">
            <input type="password" id="password" placeholder="Password">
            <button class="btn" onclick="login()">Log In</button>
            <p id="login-error" style="color:red; margin-top:10px; font-size:0.8rem;"></p>
        </div>
    </div>

    <div id="dashboard" class="hidden">
        <header>
            <div>Lufthansa Group <span style="color:var(--lh-yellow)">VA</span></div>
            <div id="user-display">Captain</div>
        </header>
        
        <nav>
            <button onclick="showTab('about')">О НАС</button>
            <button onclick="showTab('rules')">ПРАВИЛА</button>
            <button onclick="showTab('fleet')">ФЛОТ</button>
            <button onclick="showTab('routes')">НАПРАВЛЕНИЯ</button>
            <button onclick="showTab('generator')">ГЕНЕРАТОР РЕЙСА</button>
            <button onclick="showTab('pilots')">ПИЛОТЫ</button>
        </nav>

        <div class="container">
            
            <div id="active-flight-banner" class="hidden slide-up">
                <div>
                    <strong>АКТУАЛЬНЫЙ РЕЙС:</strong> <span id="af-info">EDDF - KJFK</span> | <span id="af-ac">A350-900</span>
                </div>
                <button class="btn btn-yellow" style="padding: 5px 10px; font-size:0.8rem;" onclick="completeFlight()">Завершить рейс</button>
            </div>

            <div id="tab-about" class="tab-content fade-in">
                <h2>О Нас</h2>
                <div class="card">
                    <h3>Nonstop you</h3>
                    <p>Добро пожаловать в виртуальное пространство Lufthansa Group. Мы объединяем энтузиастов авиации, стремящихся к максимальному реализму.</p>
                    <br>
                    <h4>Наши особенности:</h4>
                    <ul>
                        <li>✨ Реалистичные расписания хабов</li>
                        <li>✨ Строгое соблюдение процедур</li>
                        <li>✨ Общий флот Lufthansa, Austrian, SWISS, Brussels, Eurowings</li>
                    </ul>
                </div>
                
            </div>

            <div id="tab-rules" class="tab-content hidden fade-in">
                <h2>Правила Компании</h2>
                <div class="card">
                    <ol style="margin-left: 20px; line-height: 1.6;">
                        <li><strong>Профессионализм:</strong> Уважительное отношение ко всем участникам группы.</li>
                        <li><strong>Позывной:</strong> Использовать только присвоенный позывной.</li>
                        <li><strong>Хабы:</strong> Вылет разрешен только из хабов выбранной авиакомпании.</li>
                        <li><strong>Самолеты:</strong> Запрещено использовать дальнемагистральные суда (Heavy) на рейсах короче 2 часов без разрешения.</li>
                        <li><strong>Активность:</strong> Минимум 1 рейс в месяц.</li>
                    </ol>
                </div>
            </div>

            <div id="tab-fleet" class="tab-content hidden fade-in">
                <h2>Флот Lufthansa Group</h2>
                <div id="fleet-container" class="fleet-grid">
                    </div>
            </div>

            <div id="tab-routes" class="tab-content hidden fade-in">
                <h2>Направления и Хабы</h2>
                <div class="card">
                    <h3>Хабы Авиакомпаний</h3>
                    <ul id="hub-list-display">
                        </ul>
                </div>
            </div>

            <div id="tab-generator" class="tab-content hidden fade-in">
                <h2>Генератор Рейса</h2>
                
                <div id="generator-locked" class="card hidden" style="text-align:center; background-color: #fff3cd;">
                    <h3>У вас уже есть активный рейс!</h3>
                    <p>Вы не можете взять новый рейс, пока не завершите текущий.</p>
                </div>

                <div id="generator-form" class="card">
                    <label>Выберите Авиакомпанию:</label>
                    <select id="gen-airline" onchange="updateHubs()">
                        <option value="">-- Выбрать --</option>
                        </select>

                    <label>Выберите Хаб вылета:</label>
                    <select id="gen-hub" disabled>
                        <option value="">Сначала выберите а/к</option>
                    </select>

                    <label>Желаемое время в полете (часов):</label>
                    <select id="gen-time">
                        <option value="short">Короткий (1-3 ч)</option>
                        <option value="medium">Средний (3-7 ч)</option>
                        <option value="long">Длинный (8-14 ч)</option>
                    </select>

                    <button class="btn" onclick="generateFlight()">Сгенерировать Рейс</button>
                </div>

                <div id="gen-result" class="card hidden slide-up" style="border-left-color: var(--lh-blue);">
                    <h3 style="color: var(--lh-blue)">Ваш рейс готов</h3>
                    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:20px; margin-top:15px;">
                        <div>
                            <strong>Откуда:</strong> <span id="res-dep"></span><br>
                            <strong>Куда:</strong> <span id="res-arr"></span><br>
                            <strong>Время:</strong> <span id="res-time"></span>
                        </div>
                        <div>
                            <strong>Самолет:</strong> <span id="res-ac"></span><br>
                            <strong>Регистрация:</strong> <span id="res-reg"></span>
                        </div>
                    </div>
                    <button class="btn btn-yellow" style="margin-top:20px; width:100%;" onclick="acceptFlight()">ПРИНЯТЬ РЕЙС</button>
                </div>
            </div>

            <div id="tab-pilots" class="tab-content hidden fade-in">
                <h2>Список Пилотов</h2>
                <div class="card">
                    <table style="width:100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background:var(--lh-grey); text-align:left;">
                                <th style="padding:10px;">Позывной</th>
                                <th style="padding:10px;">Статус</th>
                            </tr>
                        </thead>
                        <tbody id="pilots-table">
                            </tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>

    <script>
        // --- DATA CONFIGURATION (РЕДАКТИРУЙ ЭТО) ---
        
        // 1. ПОЛЬЗОВАТЕЛИ (Callsign, Password)
        const USERS = [
            { callsign: "DLH001", pass: "admin123", name: "Captain Hans" },
            { callsign: "SWR202", pass: "swiss", name: "Pilot Mueller" },
            { callsign: "AUA303", pass: "vienna", name: "Pilot Weber" }
        ];

        // 2. АВИАКОМПАНИИ И ХАБЫ
        const AIRLINES = {
            "Lufthansa": ["EDDF (Frankfurt)", "EDDM (Munich)"],
            "SWISS": ["LSZH (Zurich)"], // Только 1 хаб - выбор будет заблокирован
            "Austrian": ["LOWW (Vienna)"],
            "Eurowings": ["EDDL (Dusseldorf)", "EDDH (Hamburg)", "EDDS (Stuttgart)"]
        };

        // 3. ФЛОТ (Тип, Макс. часов полета, URL картинки)
        const FLEET = [
            { type: "Airbus A319", maxHours: 5, img: "https://upload.wikimedia.org/wikipedia/commons/4/43/Lufthansa_Airbus_A319-100_D-AILU.jpg" },
            { type: "Airbus A320neo", maxHours: 6, img: "https://upload.wikimedia.org/wikipedia/commons/e/e3/Lufthansa_Airbus_A320neo_D-AINA_FRA_2016.jpg" },
            { type: "Airbus A330-300", maxHours: 11, img: "https://upload.wikimedia.org/wikipedia/commons/c/c2/Lufthansa_A330-300_D-AIKQ_01.jpg" },
            { type: "Airbus A350-900", maxHours: 16, img: "https://upload.wikimedia.org/wikipedia/commons/6/69/Lufthansa_Airbus_A350-941_D-AIXP_%2849586947268%29.jpg" },
            { type: "Boeing 747-8", maxHours: 14, img: "https://upload.wikimedia.org/wikipedia/commons/b/b8/Lufthansa_Boeing_747-830_D-ABYT.jpg" },
            { type: "Bombardier CRJ900", maxHours: 3.5, img: "https://upload.wikimedia.org/wikipedia/commons/6/63/Lufthansa_CityLine_Bombardier_CRJ-900_D-ACKI.jpg" }
        ];

        // 4. ПРИМЕРЫ НАПРАВЛЕНИЙ (Для генератора)
        const DESTINATIONS = [
            { code: "KJFK", city: "New York", hours: 8.5 },
            { code: "EGLL", city: "London", hours: 1.5 },
            { code: "OMDB", city: "Dubai", hours: 6.5 },
            { code: "RJTT", city: "Tokyo", hours: 12 },
            { code: "UUEE", city: "Moscow", hours: 3 },
            { code: "LEMD", city: "Madrid", hours: 2.5 },
            { code: "FACT", city: "Cape Town", hours: 11.5 }
        ];

        // --- SYSTEM LOGIC ---

        let currentUser = null;
        let generatedFlightTemp = null; // Временное хранение до принятия

        // Инициализация
        window.onload = function() {
            checkStorage();
            populateFleet();
            populateAirlinesSelect();
            populateHubsInfo();
            populatePilots();
        };

        function goToLogin() {
            document.getElementById('welcome-screen').classList.add('hidden');
            document.getElementById('login-screen').classList.remove('hidden');
        }

        // Авторизация
        function login() {
            const callInput = document.getElementById('callsign').value.toUpperCase();
            const passInput = document.getElementById('password').value;
            const errorMsg = document.getElementById('login-error');

            const user = USERS.find(u => u.callsign === callInput && u.pass === passInput);

            if (user) {
                currentUser = user;
                document.getElementById('user-display').innerText = `${user.callsign} | ${user.name}`;
                document.getElementById('login-screen').classList.add('hidden');
                document.getElementById('dashboard').classList.remove('hidden');
                checkActiveFlight(); // Проверка сохраненного рейса
            } else {
                errorMsg.innerText = "Неверный позывной или пароль";
            }
        }

        // Навигация
        function showTab(tabName) {
            // Скрыть все табы
            const tabs = document.getElementsByClassName('tab-content');
            for (let t of tabs) t.classList.add('hidden');
            
            // Показать выбранный
            document.getElementById(`tab-${tabName}`).classList.remove('hidden');

            // Подсветка кнопки
            // (Упрощено для примера)
        }

        // Заполнение флота
        function populateFleet() {
            const container = document.getElementById('fleet-container');
            FLEET.forEach(ac => {
                container.innerHTML += `
                    <div class="card aircraft-card">
                        <img src="${ac.img}" alt="${ac.type}">
                        <h4 style="margin-top:10px;">${ac.type}</h4>
                        <p style="font-size:0.8rem; color:#666;">Max Flight: ${ac.maxHours} hrs</p>
                    </div>
                `;
            });
        }

        // Заполнение списка пилотов
        function populatePilots() {
            const table = document.getElementById('pilots-table');
            USERS.forEach(u => {
                table.innerHTML += `
                    <tr>
                        <td style="padding:10px; border-bottom:1px solid #eee;">${u.callsign}</td>
                        <td style="padding:10px; border-bottom:1px solid #eee; color:green;">Active</td>
                    </tr>
                `;
            });
        }

        // Логика списка авиакомпаний и хабов
        function populateAirlinesSelect() {
            const sel = document.getElementById('gen-airline');
            for (let airline in AIRLINES) {
                let opt = document.createElement('option');
                opt.value = airline;
                opt.innerHTML = airline;
                sel.appendChild(opt);
            }
        }

        function populateHubsInfo() {
            const list = document.getElementById('hub-list-display');
            for (let airline in AIRLINES) {
                list.innerHTML += `<li><strong>${airline}:</strong> ${AIRLINES[airline].join(", ")}</li>`;
            }
        }

        function updateHubs() {
            const airline = document.getElementById('gen-airline').value;
            const hubSel = document.getElementById('gen-hub');
            hubSel.innerHTML = "";

            if (!airline) {
                hubSel.disabled = true;
                return;
            }

            const hubs = AIRLINES[airline];
            
            // Логика: если хаб 1 - блокируем выбор, если больше - даем выбор
            if (hubs.length === 1) {
                let opt = document.createElement('option');
                opt.value = hubs[0];
                opt.innerHTML = hubs[0];
                hubSel.appendChild(opt);
                hubSel.disabled = true; // Пилот не имеет права менять
            } else {
                hubSel.disabled = false;
                hubs.forEach(h => {
                    let opt = document.createElement('option');
                    opt.value = h;
                    opt.innerHTML = h;
                    hubSel.appendChild(opt);
                });
            }
        }

        // --- ГЕНЕРАТОР РЕЙСА ---
        function generateFlight() {
            const airline = document.getElementById('gen-airline').value;
            const hub = document.getElementById('gen-hub').value;
            const timePref = document.getElementById('gen-time').value;

            if (!airline || !hub) {
                alert("Выберите авиакомпанию и хаб!");
                return;
            }

            // 1. Фильтрация времени
            let minH, maxH;
            if (timePref === 'short') { minH = 1; maxH = 3; }
            else if (timePref === 'medium') { minH = 3; maxH = 7; }
            else { minH = 8; maxH = 14; }

            // 2. Подбор самолета (Не ставить A320 на 10 часов)
            // Ищем самолеты, у которых maxHours >= требуемого минимума
            // И исключаем "слишком мощные" для коротких рейсов (опционально, но логично)
            const availableAC = FLEET.filter(ac => {
                if (timePref === 'long') return ac.maxHours >= 8;
                if (timePref === 'short') return ac.maxHours < 8; // CRJ, A320
                return ac.maxHours >= 3;
            });

            if (availableAC.length === 0) {
                alert("Нет подходящих самолетов для такой длительности во флоте.");
                return;
            }

            const randomAC = availableAC[Math.floor(Math.random() * availableAC.length)];

            // 3. Подбор направления (Упрощенная логика - берем случайное из списка, подходящее по времени)
            // В реальном проекте тут нужна база маршрутов. Сейчас - заглушка.
            let suitableDest = DESTINATIONS.filter(d => d.hours >= minH && d.hours <= maxH);
            
            // Если точного совпадения нет, берем случайный город и "подгоняем" время
            let finalDest = suitableDest.length > 0 
                ? suitableDest[Math.floor(Math.random() * suitableDest.length)] 
                : DESTINATIONS[Math.floor(Math.random() * DESTINATIONS.length)];
            
            // Генерация времени (random в диапазоне)
            const flightTime = (Math.random() * (maxH - minH) + minH).toFixed(1);

            // Создаем объект рейса
            generatedFlightTemp = {
                dep: hub,
                arr: finalDest.code,
                ac: randomAC.type,
                time: flightTime + " hrs",
                reg: "D-A" + Math.floor(1000 + Math.random() * 9000), // Случайная регистрация
                date: new Date().toLocaleDateString()
            };

            // Отображение
            document.getElementById('res-dep').innerText = generatedFlightTemp.dep;
            document.getElementById('res-arr').innerText = generatedFlightTemp.arr;
            document.getElementById('res-time').innerText = generatedFlightTemp.time;
            document.getElementById('res-ac').innerText = generatedFlightTemp.ac;
            document.getElementById('res-reg').innerText = generatedFlightTemp.reg;

            document.getElementById('gen-result').classList.remove('hidden');
        }

        // Принятие рейса и сохранение в LocalStorage
        function acceptFlight() {
            if (!generatedFlightTemp) return;
            
            localStorage.setItem('activeFlight', JSON.stringify(generatedFlightTemp));
            
            // Сброс UI
            document.getElementById('gen-result').classList.add('hidden');
            
            checkActiveFlight();
            alert("Рейс принят! Удачного полета, капитан.");
        }

        // Проверка активности
        function checkActiveFlight() {
            const activeData = localStorage.getItem('activeFlight');
            
            if (activeData) {
                const flight = JSON.parse(activeData);
                
                // Показать баннер
                document.getElementById('active-flight-banner').classList.remove('hidden');
                document.getElementById('af-info').innerText = `${flight.dep} ➝ ${flight.arr}`;
                document.getElementById('af-ac').innerText = flight.ac;

                // Блокировать генератор
                document.getElementById('generator-form').classList.add('hidden');
                document.getElementById('generator-locked').classList.remove('hidden');
            } else {
                document.getElementById('active-flight-banner').classList.add('hidden');
                document.getElementById('generator-form').classList.remove('hidden');
                document.getElementById('generator-locked').classList.add('hidden');
            }
        }

        function checkStorage() {
            // Здесь можно добавить логику восстановления сессии пользователя, если нужно
        }

        function completeFlight() {
            if(confirm("Вы завершили полет и находитесь на стоянке?")) {
                localStorage.removeItem('activeFlight');
                checkActiveFlight();
                alert("Рейс завершен и записан в журнал (симуляция).");
            }
        }

    </script>
</body>
</html>
