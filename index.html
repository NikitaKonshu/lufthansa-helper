<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>LGV — Minimal</title>
  <meta name="color-scheme" content="light dark">
  <style>
    :root{
      --bg:#0b1220;
      --card:#0f1724;
      --muted:#96a0b4;
      --accent:#9dd1ff;
      --text:#e6eef8;
      --soft:#0b1420;
      --radius:12px;
      --gap:14px;
      --shadow: 0 6px 20px rgba(2,8,20,0.6);
      --max-w:980px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial;background:linear-gradient(180deg,var(--bg),#071121);color:var(--text);
      display:flex;align-items:center;justify-content:center;padding:20px;
    }

    .wrap{width:100%;max-width:var(--max-w)}
    /* header */
    header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:18px}
    .brand{display:flex;gap:12px;align-items:center}
    .badge{width:48px;height:48px;border-radius:10px;background:linear-gradient(180deg,#071e2b,#0a394b);display:flex;align-items:center;justify-content:center;color:var(--accent);font-weight:800}
    h1{margin:0;font-size:18px;letter-spacing:0.2px}
    p.lead{margin:0;color:var(--muted);font-size:13px}

    /* container */
    .card{
      background:linear-gradient(180deg,var(--card),#091523);
      border-radius:var(--radius);box-shadow:var(--shadow);padding:18px;
      display:grid;grid-template-columns:1fr 300px;gap:18px;align-items:start;
    }
    @media(max-width:860px){.card{grid-template-columns:1fr}}

    /* left column */
    .section{margin-bottom:12px}
    .label{font-size:13px;color:var(--muted);margin-bottom:8px;font-weight:600}
    .options{display:flex;flex-wrap:wrap;gap:10px}
    .chip{
      background:transparent;border:1px solid rgba(255,255,255,0.04);padding:10px 12px;border-radius:10px;cursor:pointer;
      display:flex;align-items:center;gap:10px;min-width:120px;transition:transform .15s ease;
    }
    .chip:hover{transform:translateY(-3px)}
    .chip.selected{background:linear-gradient(90deg, rgba(157,209,255,0.08), rgba(157,209,255,0.04));border-color:rgba(157,209,255,0.22)}
    .chip .mono{font-weight:800;color:var(--accent);min-width:36px;text-align:center;border-radius:6px;padding:6px 8px;background:rgba(255,255,255,0.01)}

    /* actions */
    .actions{display:flex;gap:10px;margin-top:14px}
    .btn{padding:10px 14px;border-radius:10px;border:0;font-weight:700;cursor:pointer}
    .btn.primary{background:var(--accent);color:#062036}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--text)}

    /* result */
    .result{margin-top:14px;background:rgba(255,255,255,0.02);padding:12px;border-radius:10px;display:none}
    .row{display:flex;justify-content:space-between;align-items:center;padding:6px 0;border-bottom:1px solid rgba(255,255,255,0.02)}
    .row:last-child{border-bottom:none}
    .k{color:var(--muted);font-size:13px}
    .v{font-weight:800}

    /* right column */
    aside{padding:12px;background:rgba(255,255,255,0.01);border-radius:10px}
    .meta{font-size:13px;color:var(--muted)}
    .meta strong{color:var(--text);font-weight:800}
    .tiny{font-size:12px;color:var(--muted);margin-top:10px}

    /* mobile tweaks */
    @media(max-width:480px){
      header{flex-direction:column;align-items:flex-start;gap:8px}
      .badge{width:44px;height:44px}
      .card{padding:14px}
      .chip{min-width:100px}
      .actions{flex-direction:column;align-items:stretch}
      .btn{width:100%}
    }
  </style>
</head>
<body>
  <div class="wrap" role="application" aria-label="LGV Minimal">
    <header>
      <div class="brand">
        <div class="badge" aria-hidden="true">LG</div>
        <div>
          <h1>Lufthansa Group Virtual</h1>
          <p class="lead">Минималистичный генератор рейсов — встроенные данные, мгновенно</p>
        </div>
      </div>
      <div class="meta">Встроено: Frankfurt EDDF + Munich EDDM</div>
    </header>

    <main class="card" role="main">
      <section>
        <div class="section">
          <div class="label">Авиакомпания</div>
          <div id="air" class="options" aria-label="Список авиакомпаний"></div>
        </div>

        <div class="section">
          <div class="label">Длительность</div>
          <div id="dur" class="options" aria-label="Интервалы длительности"></div>
        </div>

        <div class="actions">
          <button id="go" class="btn primary" aria-label="Генерировать рейс">Генерировать</button>
          <button id="d" class="btn ghost" aria-label="Демо">Демо</button>
          <button id="c" class="btn ghost" aria-label="Сброс">Сброс</button>
        </div>

        <div id="out" class="result" role="status" aria-live="polite"></div>
      </section>

      <aside>
        <div class="meta">Маршрутов в наборе: <strong id="total">—</strong></div>
        <div class="tiny">Показываем реальное значение durationMinutes, если оно доступно; иначе генерируем значение в выбранном интервале.</div>
        <div style="margin-top:12px">
          <button id="log" class="btn ghost" style="width:100%">Показать 8 маршрутов в консоли</button>
        </div>
      </aside>
    </main>
  </div>

<script>
/* Minimal logic + embedded routes */
const ROUTES = [
  {"fromCity":"Frankfurt am Main","fromCountry":"Germany","fromICAO":"EDDF","toCity":"Oslo","toCountry":"Norway","toICAO":"ENGM","durationMinutes":120},
  {"fromCity":"Frankfurt am Main","fromCountry":"Germany","fromICAO":"EDDF","toCity":"Amsterdam","toCountry":"Netherlands","toICAO":"EHAM","durationMinutes":70},
  {"fromCity":"Frankfurt am Main","fromCountry":"Germany","fromICAO":"EDDF","toCity":"London","toCountry":"United Kingdom","toICAO":"EGLL","durationMinutes":75},
  {"fromCity":"Frankfurt am Main","fromCountry":"Germany","fromICAO":"EDDF","toCity":"Paris","toCountry":"France","toICAO":"LFPG","durationMinutes":85},
  {"fromCity":"Frankfurt am Main","fromCountry":"Germany","fromICAO":"EDDF","toCity":"Munich","toCountry":"Germany","toICAO":"EDDM","durationMinutes":50},
  {"fromCity":"Munich","fromCountry":"Germany","fromICAO":"EDDM","toCity":"London","toCountry":"United Kingdom","toICAO":"EGLL","durationMinutes":85},
  {"fromCity":"Munich","fromCountry":"Germany","fromICAO":"EDDM","toCity":"Zurich","toCountry":"Switzerland","toICAO":"LSZH","durationMinutes":60},
  {"fromCity":"Munich","fromCountry":"Germany","fromICAO":"EDDM","toCity":"Oslo","toCountry":"Norway","toICAO":"ENGM","durationMinutes":135},
  {"fromCity":"Frankfurt am Main","fromCountry":"Germany","fromICAO":"EDDF","toCity":"New York","toCountry":"United States","toICAO":"KJFK","durationMinutes":450},
  {"fromCity":"Munich","fromCountry":"Germany","fromICAO":"EDDM","toCity":"New York","toCountry":"United States","toICAO":"KJFK","durationMinutes":450}
];

const AIRLINES = [
  {name:"Lufthansa", hubs:["EDDF","EDDM"]},
  {name:"Austrian", hubs:["LOWW"]},
  {name:"Swiss", hubs:["LSZH"]}
];

const DURATIONS = [
  {label:"1–2 ч",min:60,max:120},
  {label:"3–4 ч",min:180,max:240},
  {label:"5–6 ч",min:300,max:360},
  {label:"7–8 ч",min:420,max:480},
  {label:"9–10 ч",min:540,max:600},
  {label:"10+ ч",min:601,max:1200}
];

/* Refs */
const airEl = document.getElementById('air');
const durEl = document.getElementById('dur');
const goBtn = document.getElementById('go');
const demoBtn = document.getElementById('d');
const resetBtn = document.getElementById('c');
const out = document.getElementById('out');
const total = document.getElementById('total');
const logBtn = document.getElementById('log');

let selAir = null;
let selDur = null;

/* Utils */
function clamp(n,min,max){return Math.max(min,Math.min(max,n))}
function rnd(a,b){return Math.floor(Math.random()*(b-a+1))+a}
function esc(s){return String(s||'').replace(/[&<>"']/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]))}

/* Render chips */
function renderAir(){
  airEl.innerHTML = '';
  AIRLINES.forEach((a,i)=>{
    const el = document.createElement('button');
    el.className = 'chip';
    el.type = 'button';
    el.innerHTML = `<span class="mono">${a.name.split(' ').map(x=>x[0]).slice(0,2).join('')}</span><div style="text-align:left"><div style="font-weight:700">${a.name}</div><div style="font-size:12px;color:var(--muted)">${a.hubs.join(', ')}</div></div>`;
    el.onclick = ()=>{ selectAir(i); };
    el.onkeydown = (e)=>{ if(e.key==='Enter') selectAir(i); };
    airEl.appendChild(el);
  });
}
function renderDur(){
  durEl.innerHTML = '';
  DURATIONS.forEach((d,i)=>{
    const el = document.createElement('button');
    el.className = 'chip';
    el.type = 'button';
    el.innerHTML = `<span class="mono">⌛</span><div style="text-align:left"><div style="font-weight:700">${d.label}</div><div style="font-size:12px;color:var(--muted)">~ ${Math.round(((d.min+d.max)/2)/60)} ч</div></div>`;
    el.onclick = ()=>{ selectDur(i); };
    el.onkeydown = (e)=>{ if(e.key==='Enter') selectDur(i); };
    durEl.appendChild(el);
  });
}

/* Selectors */
function selectAir(i){
  selAir = i;
  Array.from(airEl.children).forEach((c,idx)=> c.classList.toggle('selected', idx===i));
  out.style.display='none';
}
function selectDur(i){
  selDur = i;
  Array.from(durEl.children).forEach((c,idx)=> c.classList.toggle('selected', idx===i));
  out.style.display='none';
}

/* Filtering logic */
function filterByHubAndDuration(airIdx,durIdx){
  const hubs = AIRLINES[airIdx].hubs.map(h=>h.toUpperCase());
  let pool = ROUTES.filter(r => hubs.includes((r.fromICAO||'').toUpperCase()));
  if(!Array.isArray(pool) || pool.length===0) return [];

  if(typeof durIdx !== 'number') return pool;

  const interval = DURATIONS[durIdx];
  const exact = pool.filter(r => Number.isFinite(r.durationMinutes) && r.durationMinutes >= interval.min && r.durationMinutes <= interval.max);
  if(exact.length) return exact;

  // nearest by midpoint
  const midpoint = (interval.min + interval.max)/2;
  const withNum = pool.filter(r => Number.isFinite(r.durationMinutes));
  if(!withNum.length) return pool;
  let best = withNum.reduce((acc,r)=>{
    const d = Math.abs(r.durationMinutes - midpoint);
    if(acc.diff === undefined || d < acc.diff) return {diff:d,list:[r]};
    if(Math.abs(d - acc.diff) < 1) acc.list.push(r);
    return acc;
  },{});
  return best.list || withNum.slice(0,20);
}

/* Generate */
function prettyTime(mins){
  const hh = Math.floor(mins/60); const mm = mins%60;
  return hh.toString().padStart(2,'0') + ':' + mm.toString().padStart(2,'0');
}
function generate(){
  if(selAir === null){ alert('Выберите авиакомпанию'); return; }
  if(selDur === null){ alert('Выберите длительность'); return; }

  const pool = filterByHubAndDuration(selAir, selDur);
  if(!pool.length){ out.style.display='block'; out.innerHTML = `<div class="row"><div class="k">Ошибка</div><div class="v">Нет маршрутов для выбранных параметров</div></div>`; return; }

  const route = pool[rnd(0, pool.length-1)];
  let mins = Number.isFinite(route.durationMinutes) ? Math.round(route.durationMinutes) : rnd(DURATIONS[selDur].min, DURATIONS[selDur].max);

  out.style.display='block';
  out.innerHTML = `
    <div class="row"><div class="k">Авиакомпания</div><div class="v">${esc(AIRLINES[selAir].name)}</div></div>
    <div class="row"><div class="k">Отправление</div><div class="v">${esc(route.fromCity)} <span style="color:var(--muted)">(${esc(route.fromICAO)})</span></div></div>
    <div class="row"><div class="k">Прибытие</div><div class="v">${esc(route.toCity)} <span style="color:var(--muted)">(${esc(route.toICAO)})</span></div></div>
    <div class="row"><div class="k">Время полёта</div><div class="v">${prettyTime(mins)}</div></div>
    <div class="row"><div class="k">Источник</div><div class="v">${Number.isFinite(route.durationMinutes) ? 'durationMinutes (встроено)' : 'Сгенерировано'}</div></div>
  `;
}

/* Controls */
function demo(){
  selectAir(0); selectDur(3); generate();
}
function clearAll(){
  selAir = null; selDur = null;
  Array.from(airEl.children).forEach(c=>c.classList.remove('selected'));
  Array.from(durEl.children).forEach(c=>c.classList.remove('selected'));
  out.style.display='none';
}
function showLog(){ console.log('ROUTES sample:', ROUTES.slice(0,8)); alert('8 маршрутов выведены в консоль'); }

/* Init */
function init(){
  renderAir(); renderDur();
  total.textContent = ROUTES.length;
  goBtn.addEventListener('click', generate);
  demoBtn.addEventListener('click', demo);
  resetBtn.addEventListener('click', clearAll);
  logBtn.addEventListener('click', showLog);
}
init();
</script>
</body>
</html>
