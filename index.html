<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Lufthansa Group Virtual — Простой (с ручным временем)</title>
  <style>
    :root{
      --bg:#021428; --accent:#ffd400; --text:#fff; --muted:rgba(255,255,255,0.75);
      --card: rgba(255,255,255,0.02); --btn: rgba(255,212,0,0.12);
    }
    *{box-sizing:border-box}
    body{margin:0;min-height:100vh;font-family:Inter,system-ui,Roboto,Arial;background:var(--bg);color:var(--text);display:flex;align-items:center;justify-content:center;padding:20px}
    .wrap{width:100%;max-width:860px}
    .hero{background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);padding:28px;border-radius:12px;text-align:center;border:1px solid rgba(255,255,255,0.03);margin-bottom:16px}
    .logo{font-weight:800;color:var(--accent);font-size:22px;margin-bottom:6px}
    .lead{color:var(--muted);margin-bottom:14px}
    .btn-main{background:var(--btn);border:2px solid rgba(255,212,0,0.14);color:var(--accent);padding:12px 20px;border-radius:10px;font-weight:800;cursor:pointer}
    .card{background:var(--card);padding:18px;border-radius:12px;border:1px solid rgba(255,255,255,0.03)}
    .section-title{color:var(--muted);font-weight:700;margin:8px 0}
    .options{display:flex;gap:10px;flex-wrap:wrap}
    .opt{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:8px 12px;border-radius:8px;cursor:pointer;color:var(--text);font-weight:700}
    .opt.selected{border-color:rgba(255,212,0,0.28);box-shadow:0 8px 20px rgba(0,0,0,0.6)}
    .controls{margin-top:14px;display:flex;gap:8px;flex-wrap:wrap}
    .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:8px 12px;border-radius:8px;color:var(--text);cursor:pointer}
    .result{margin-top:14px;background:rgba(255,255,255,0.02);padding:14px;border-radius:10px;border:1px solid rgba(255,255,255,0.03)}
    .r-row{display:flex;justify-content:space-between;gap:12px;align-items:center;margin:6px 0}
    .label{color:var(--muted);font-size:13px}
    .value{font-weight:800}
    .icao{color:var(--accent);font-weight:900}
    input[type="number"]{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:8px;border-radius:8px;color:var(--text);width:120px}
    @media(max-width:520px){.r-row{flex-direction:column;align-items:flex-start}}
  </style>
</head>
<body>
  <div class="wrap">
    <!-- Start -->
    <div id="start" class="hero">
      <div class="logo">Lufthansa Group Virtual</div>
      <div class="lead">Простая генерация тестовых рейсов. Нажми «Начать» и выбери авиакомпанию и длительность.</div>
      <button id="btn-start" class="btn-main">Начать</button>
    </div>

    <!-- Main card -->
    <div id="main" class="card" style="display:none">
      <div class="section-title">1. Выберите авиакомпанию</div>
      <div id="airlines" class="options"></div>

      <div class="section-title" style="margin-top:12px">2. Выберите длительность</div>
      <div id="durations" class="options"></div>

      <div class="section-title" style="margin-top:12px">3. Опционально: введите время вручную (в минутах)</div>
      <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap">
        <input id="custom-minutes" type="number" min="1" placeholder="минуты" />
        <div class="small" style="color:var(--muted)">Если поле заполнено — оно будет использовано как время в полёте</div>
      </div>

      <div class="controls">
        <button id="btn-gen" class="btn-main">Сгенерировать</button>
        <button id="btn-back" class="btn-ghost">Назад</button>
      </div>

      <div id="result" class="result" style="display:none" aria-live="polite"></div>
    </div>
  </div>

  <script>
    /**************************************************************************
     * DATA (редактируй тут)
     * AIRLINES: каждый объект {name, hubs: [ICAO,...]}
     * ROUTES: {fromCity, fromCountry, fromICAO, toCity, toCountry, toICAO, optional durationMinutes}
     **************************************************************************/
    const AIRLINES = [
      {name:"Lufthansa", hubs:["EDDF","EDDM"]},
      {name:"Austrian", hubs:["LOWW"]},
      {name:"Swiss", hubs:["LSZH"]},
      {name:"Eurowings", hubs:["EDDF","EDDM","EDDH"]}
    ];

    const ROUTES = [
      {fromCity:"Frankfurt am Main", fromCountry:"Germany", fromICAO:"EDDF", toCity:"New York", toCountry:"United States", toICAO:"KJFK", durationMinutes:450},
      {fromCity:"Frankfurt am Main", fromCountry:"Germany", fromICAO:"EDDF", toCity:"Washington", toCountry:"United States", toICAO:"KDCA"},
      {fromCity:"Munich", fromCountry:"Germany", fromICAO:"EDDM", toCity:"London", toCountry:"United Kingdom", toICAO:"EGLL"},
      {fromCity:"Vienna", fromCountry:"Austria", fromICAO:"LOWW", toCity:"Berlin", toCountry:"Germany", toICAO:"EDDB", durationMinutes:75},
      {fromCity:"Zurich", fromCountry:"Switzerland", fromICAO:"LSZH", toCity:"Frankfurt am Main", toCountry:"Germany", toICAO:"EDDF"},
      {fromCity:"Hamburg", fromCountry:"Germany", fromICAO:"EDDH", toCity:"Barcelona", toCountry:"Spain", toICAO:"LEBL"}
      // Добавляй новые маршруты сюда; для ручного времени добавь durationMinutes
    ];

    const DURATIONS = [
      {label:"1-2 часа", min:60, max:120},
      {label:"2-4 часа", min:121, max:240},
      {label:"4-6 часов", min:241, max:360},
      {label:"6+ часов", min:361, max:1200}
    ];

    /**************************************************************************
     * Логика
     **************************************************************************/
    const elStart = document.getElementById('start');
    const elMain = document.getElementById('main');
    const elAir = document.getElementById('airlines');
    const elDur = document.getElementById('durations');
    const btnStart = document.getElementById('btn-start');
    const btnBack = document.getElementById('btn-back');
    const btnGen = document.getElementById('btn-gen');
    const res = document.getElementById('result');
    const customMinutesEl = document.getElementById('custom-minutes');

    let chosenAir = null;
    let chosenDur = null;

    function renderAirlines(){
      elAir.innerHTML = '';
      AIRLINES.forEach((a,i)=>{
        const d = document.createElement('div');
        d.className='opt'; d.tabIndex=0; d.textContent = a.name;
        d.onclick = ()=> selectAir(i); d.onkeypress = e=>{ if(e.key==='Enter') selectAir(i) };
        elAir.appendChild(d);
      });
    }
    function renderDurations(){
      elDur.innerHTML=''; DURATIONS.forEach((d,i)=>{ const n=document.createElement('div'); n.className='opt'; n.tabIndex=0; n.textContent=d.label; n.onclick=()=> selectDur(i); n.onkeypress=e=>{ if(e.key==='Enter') selectDur(i) }; elDur.appendChild(n); });
    }

    function selectAir(i){
      chosenAir = AIRLINES[i];
      Array.from(elAir.children).forEach((n,idx)=> n.classList.toggle('selected', idx===i));
      res.style.display='none';
    }
    function selectDur(i){
      chosenDur = DURATIONS[i];
      Array.from(elDur.children).forEach((n,idx)=> n.classList.toggle('selected', idx===i));
      res.style.display='none';
    }

    function randInt(min,max){ return Math.floor(Math.random()*(max-min+1))+min; }
    function pad(n){ return String(n).padStart(2,'0'); }
    function escapeHtml(s){ return String(s).replace(/[&<>"']/g, c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }

    function generate(){
      if(!chosenAir || !chosenDur){ alert('Выберите авиакомпанию и длительность'); return; }
      const filtered = ROUTES.filter(r => chosenAir.hubs.includes(r.fromICAO));
      if(filtered.length===0){
        res.innerHTML = `<div class="r-row"><div class="label">Ошибка</div><div class="value">Нет маршрутов из хабов ${escapeHtml(chosenAir.name)}. Добавь в ROUTES.</div></div>`;
        res.style.display='block';
        return;
      }
      const route = filtered[randInt(0, filtered.length-1)];

      // выбор времени: приоритет — пользовательское поле -> durationMinutes в маршруте -> диапазон
      const custom = Number(customMinutesEl.value);
      let minutes;
      if(Number.isFinite(custom) && custom > 0){
        minutes = Math.round(custom);
      } else if(route.durationMinutes && Number.isFinite(route.durationMinutes)){
        minutes = Math.round(route.durationMinutes);
      } else {
        minutes = randInt(chosenDur.min, chosenDur.max);
      }

      const hh = Math.floor(minutes/60), mm = minutes%60;
      const time = pad(hh) + ':' + pad(mm);

      res.innerHTML = `
        <div class="r-row"><div class="label">Отправление</div><div class="value">${escapeHtml(route.fromCity)}, ${escapeHtml(route.fromCountry)}</div></div>
        <div class="r-row"><div class="label">ICAO отправления</div><div class="value icao">${escapeHtml(route.fromICAO)}</div></div>
        <div class="r-row"><div class="label">Прибытие</div><div class="value">${escapeHtml(route.toCity)}, ${escapeHtml(route.toCountry)}</div></div>
        <div class="r-row"><div class="label">ICAO прибытия</div><div class="value icao">${escapeHtml(route.toICAO)}</div></div>
        <div class="r-row" style="margin-top:8px"><div class="label">Время в полёте</div><div class="value flight">${time}</div></div>
      `;
      res.style.display='block';
      res.scrollIntoView({behavior:'smooth', block:'nearest'});
    }

    // навигация
    btnStart.addEventListener('click', ()=>{ elStart.style.display='none'; elMain.style.display='block'; renderAirlines(); renderDurations(); });
    btnBack.addEventListener('click', ()=>{ elMain.style.display='none'; elStart.style.display='block'; chosenAir=null; chosenDur=null; res.style.display='none'; customMinutesEl.value=''; Array.from(elAir.children).forEach(n=>n.classList.remove('selected')); Array.from(elDur.children).forEach(n=>n.classList.remove('selected')) });
    btnGen.addEventListener('click', generate);

    // init
    (function init(){ renderAirlines(); renderDurations(); })();
  </script>
</body>
</html>
